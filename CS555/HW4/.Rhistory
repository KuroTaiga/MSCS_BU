install.packages(c("rmarkdown", "knitr"))
#install.packages("asbio")
# https://cran.r-project.org/web/packages/asbio/index.html
library(asbio)
#Compute z*
ConfLevel <- 0.99 #Define confidence level
LeftTail <- ConfLevel+(1-ConfLevel)/2
zStar <- qnorm(LeftTail)
rnorm(100,mean = 114, sd = 514)
rnorm(100,mean = 114, sd = i)
rnorm(100,mean = 114, sd = -1)
rnorm(100,mean = 114, sd = 514)
quantile(rnorm(100,mean = 114, sd = 514))
mean(rnorm(100,114,514))
mean(rnorm(100,1,10000))
mean(rnorm(100,1,10000))
mean(rnorm(100,1,10000))
mean(rnorm(100,1,10000))
sd(rnorm(100,1,100))
sd(rnorm(100,1,10000))
sd(rnorm(100,114,514))
sd(rnorm(100,114,514))
sd(rnorm(100,114,514))
sd(rnorm(100,114,514))
sd(rnorm(100,114,514))
sd(rnorm(100,114,514))
sd(rnorm(100,114,514))
sd(rnorm(100,114,514))
sd(rnorm(100,114,514))
#Compute z*
ConfLevel <- 0.99 #Define confidence level
LeftTail <- ConfLevel+(1-ConfLevel)/2
zStar <- qnorm(LeftTail)
dim()
a <- rnorm(rnorm(100,114,514) )
b <- sample(a, 49)
mean(b)
mean(a)
a <- rnorm(100,114,514)
b <- sample(a, 49)
mean(b)
mean(a)
b <- sample(a, 64)
mean(a)
mean(b)
3.6/6
3.5/6
2.576*3.5/6
92.83735-1.96*(sd(b)/8)
sd(b)
sd(a)
92.83735-1.96*(sd(a)/8)
1.96*sd(a)/8
a<-rnorm(100,10,10)
b<-sample(a,36)
sd(a)
sd(b)
mean(b)+1.96*10/8
mean(b)-1.96*10/8
mea(a)
mean(a)
mean(b)-1.645*10/8
mean(b)+1.645*10/8
qnorm(.1,lower.tail = F)
mean(b)-1.28*10/8
mean(b)+1.28*10/8
qnorm(.25,lower.tail = F)
(15/1*1.96)^2
ceiling((15/1*1.96)^2)
?one.sample.z
sd(a)
SD<-sd(a)
b <- sample(a,36)
mean(b)
bmean <- mean(b)
bmean <- 11
se = SD/6
critZ <- (mean(b)-bmean)/se
critZ <- (mean(b)-20)/se
one.sample.z(null.mu = 0, xbar = -2.98, sigma = 6, n=30,alternative = "one.sided")
one.sample.z(null.mu = 0, xbar = -2.98, sigma = 6, n=30,alternative = "less")
one.sample.z(null.mu = 155, xbar = 117, sigma = 30, n=100,alternative = "two.sided")
one.sample.z(null.mu = 115, xbar = 117, sigma = 30, n=100,alternative = "two.sided")
##Critical value approach
1.5967 > qnorm(0.975)
##P value approach
##replicate p value
pnorm(1.597, lower.tail = F)*2
##compare p value with alpha level
0.11 < 0.05
help("fit")
??fit
library(python)
install.packages("reticulate")
one.sample.z(null.mu = 42, xbar = 38.37524, sigma = 23.74226, n=36,alternative = "two.sided")
one.sample.z(null.mu = 42, xbar = 38.37524, sigma = 23.74226, n=36,alternative = "two.si")
one.sample.z(null.mu = 42, xbar = 38.37524, sigma = 23.74226, n=36,alternative = "less")
sigma <- 169
(xbar <- mean(sample))
(z <- qnorm(0.975))
(cl <- c(xbar-z*sigma/sqrt(40), xbar+z*sigma/sqrt(40)))
one.sample.z(null.mu=919, xbar=xbar, sigma=169,
n=40, alternative="two.sided", conf=0.95)
z <- qnorm(0.975)
sigma <- 4
m <- 0.5
n <- (z*sigma/m)^2
n
one.sample.z(null.mu=10, xbar=10.8, sigma=1,
n=30, alternative="greater", conf=0.95)
one.sample.z(null.mu=10, xbar=10.8, sigma=1,
n=30, alternative="greater")
zval <- (16.4-15)/(6.2/sqrt(50))
(zval <- (16.4-15)/(6.2/sqrt(50)))
##Critical value approach
1.5967 > qnorm(0.975)
kid_cal <- read.csv("kid_cal.csv")
summary(kid_cal)
Kid_mean <- kid_cal$trt
Kid_meal <- kid_cal$trt = T
kid_cal <- read.csv("kid_cal.csv")
Kid_meal <- kid_cal$trt = T
Kid_meal <- kid_cal[kid_cal$trt = T]
Kid_meal <- kid_cal[kid_cal$trt == T]
Kid_meal <- kid_cal$Calories[kid_cal$trt == T]
Kid_no_meal <- kid_cal$Calories[kid_cal$trt == F]
hist(Kid_meal)
par(mfrow = c(2,2))
hist(Kid_meal)
hist(Kid_no_meal)
knitr::opts_chunk$set(echo = TRUE)
hist(Kid_no_meal, main = "Calorie Distribution for Non-Participants",
xlab = "Calorie", freq = F)
hist(Kid_no_meal, main = "Calorie Distribution for Non-Participants",
xlab = "Calorie", ylab = "Child Count")
knitr::opts_chunk$set(echo = TRUE)
kid_cal <- read.csv("kid_cal.csv")
Kid_meal <- kid_cal$Calories[kid_cal$trt == T]
Kid_no_meal <- kid_cal$Calories[kid_cal$trt == F]
mealFrame <- data.frame(
Mean = mean(Kid_meal),
Median = median(Kid_meal),
SD = sd(Kid_meal),
First_Quantile = quantile(Kid_meal,.25)[[1]],
Third_Quantile = quantile(Kid_meal,.75)[[1]],
Min = min(Kid_meal),
Max = max(Kid_meal)
)
daysTable <- kable(mealFrame,"simple")
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
kid_cal <- read.csv("kid_cal.csv")
Kid_meal <- kid_cal$Calories[kid_cal$trt == T]
Kid_no_meal <- kid_cal$Calories[kid_cal$trt == F]
mealFrame <- data.frame(
Mean = mean(Kid_meal),
Median = median(Kid_meal),
SD = sd(Kid_meal),
First_Quantile = quantile(Kid_meal,.25)[[1]],
Third_Quantile = quantile(Kid_meal,.75)[[1]],
Min = min(Kid_meal),
Max = max(Kid_meal)
)
daysTable <- kable(mealFrame,"simple")
par(mfrow = c(2,2))
hist(Kid_meal, main = "Calorie Distribution for Participants",
xlab = "Calorie", ylab = "Child Count")
hist(Kid_no_meal, main = "Calorie Distribution for Non-Participants",
xlab = "Calorie", ylab = "Child Count")
(mealTable <- kable(mealFrame,"simple"))
(mealTable <- kable(mealFrame,"simple", label = "Summary of Calorie for Participants of Meal Preparation"))
setwd("C:/BU/CSSE/CS555/HW4/")
ls
ls()
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
hw4_data <- read.csv("./A04.csv")
hw4_df <- data.frame(Education_Level = hw4_data$EL,
Income = hw4_data$Inc,
Women_Percentage = hw4_data$Perc,
Prestige_Score = hw4_data$Score)
?labels
?pairs
pairs(hw4_df,labels = "Scattor plot of the data")
pairs(hw4_df)
hw4_m_el <- lm(Prestige_Score ~ Education_Level,data = hw4_df)
ggplot
?ggplot
attach(hw4_data)
plot(Prestige_Score)
plot(hw4_data$Prestige_Score)
plot(EL ,Score)
plot(EL ,Score, xlab = "Education Level (years)", ylab = "Prestige Score")
EL_Score_cor <- cor(EL,Score)
EL_Score_cor
?cor
plot(EL ,Score, xlab = "Education Level (years)", ylab = "Prestige Score")
hw4_m_el <- lm(Score ~ EL,data = hw4_df)
summary(hw4_m_el)
?hw4_m_el
??hw4_m_el
resid(m)
ceo<-read.csv("../L8/CEO_salary.csv")
head(ceo)
salary1 <- ceo$salary/1000
ceo1 <- data.frame(age=ceo$age,
height=ceo$height,
salary_in_k=salary1)
scatterplot(ceo1$salary_in_k~ceo1$age)
scatterplot(ceo1$salary_in_k~ceo1$height)
library(car) #  Companion to Applied Regression
scatterplot(ceo1$salary_in_k~ceo1$age)
scatterplot(ceo1$salary_in_k~ceo1$height)
# Fit a Multiple Linear Regression model into data.
# Variables are Salary and age and store the resulted model into a variable for further use.
m <- lm(ceo1$salary_in_k~ceo1$age+ceo1$height)
m
resid(m)
par()              #Query Graphical Parameters
plot(fitted(m), resid(m), axes=TRUE, frame.plot=TRUE, xlab='fitted values', ylab='residue')
hist(resid(m))
resid_el <-resid(hw4_m_el)
summary(hw4_m_el)
outlierTest(hw4_m_el)
b <- influence.measures(hw4_m_el)
c <- which(apply(b$is.inf, 1, any))
hw4_data[rownames(hw4_data) %in% c, ]
library(car)
plot(EL,resid_el,xlab = "Education level (years)",ylab = "Residual", "Residual Plot")
plot(EL,resid_el,xlab = "Education level (years)",ylab = "Residual", "Residual Plot")
plot(EL ,resid_el ,xlab = "Education level (years)",ylab = "Residual", main = "Residual Plot")
abline(0,0)
plot(EL ,resid_el ,xlab = "Education level (years)",ylab = "Residual", main = "Residual Plot")
abline(0,0)
plot.new(EL ,resid_el ,xlab = "Education level (years)",ylab = "Residual", main = "Residual Plot")
abline(0, 0)
plot.new(EL ,resid_el ,xlab = "Education level (years)",ylab = "Residual", main = "Residual Plot")
plot.new()
plot(EL ,resid_el ,xlab = "Education level (years)",ylab = "Residual", main = "Residual Plot")
abline(0, 0)
plot(EL ,resid_el ,xlab = "Education level (years)",ylab = "Residual", main = "Residual Plot")
abline(0, 0)
resid_el[41,46,53]
resid_el[41]
resid_el[40]
par(mfrow = c(3,1))
plot(EL ,resid_el ,xlab = "Education level (years)",ylab = "Residual", main = "Residual Plot")
?hist
hist(resid_el,main = "Histogram plot of residuals")
par(mfrow = c(2,1))
plot(EL ,resid_el ,xlab = "Education level (years)",ylab = "Residual", main = "Residual Plot")
abline(0, 0)
hist(resid_el,main = "Histogram plot of residuals")
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(car)
hw4_data <- read.csv("./A04.csv")
attach(hw4_data)
#summary(hw4_data)
hw4_df <- data.frame(Education_Level = hw4_data$EL,
Income = hw4_data$Inc,
Women_Percentage = hw4_data$Perc,
Prestige_Score = hw4_data$Score)
pairs(hw4_df)
plot(EL ,Score, xlab = "Education Level (years)", ylab = "Prestige Score")
EL_Score_cor <- cor(EL,Score)
hw4_m_el <- lm(Score ~ EL,data = hw4_df)
resid_el <-resid(hw4_m_el)
summary(hw4_m_el)
par(mfrow = c(2,1))
plot(EL ,resid_el ,xlab = "Education level (years)",ylab = "Residual", main = "Residual Plot")
abline(0, 0)
hist(resid_el,main = "Histogram plot of residuals")
par(mfrow = c(1,2))
plot(EL ,resid_el ,xlab = "Education level (years)",ylab = "Residual", main = "Residual Plot")
abline(0, 0)
par(mfrow = c(1,2))
plot(EL ,resid_el ,xlab = "Education level (years)",ylab = "Residual", main = "Residual Plot")
abline(0, 0)
hist(resid_el,main = "Histogram plot of residuals")
hw4_data[rownames(hw4_data) %in% c, ]
hw4_lm(Score ~ EL, Inc,Perc)
hw4_lm<-lm(Score ~ EL, Inc,Perc)
hw4_lm<-lm(Score ~ EL, Inc,Perc,data = hw4_data)
hw4_lm<-lm(Score ~ EL + Inc + Perc,data = hw4_data)
residual_hw4 <- resid(hw4_lm)
summary(hw4_lm)
length(Score)
qf(3,98,0.05)
qf(0.05,3,98)
qf(0.05,3,98)
anova(hw4_lm)
summary(hw4_lm)
qf(0.05,3,98)
```
hw4_data[rownames(hw4_data) %in% c, ]
summary(hw4_lm)
confint(hw4_lm,0.95)
confint(hw4_lm,level =0.95)
summary(hw4_lm)
confint(hw4_lm,level =0.95)
summary(hw4_lm)[2]
summary(hw4_lm)[2][2]
summary(hw4_lm)[2]
summary(hw4_lm)$infmat
summary(hw4_lm)[1]
summary(hw4_lm)[2]
summary(hw4_lm)[3]
summary(hw4_lm)[4]
summary(hw4_lm)[4][2]
summary(hw4_lm)[4][1]
summary(hw4_lm)[4][1][2]
summary(hw4_lm)[4][1][1]
summary(hw4_lm)[4][[2]]
summary(hw4_lm)[4][4]
summary(hw4_lm)[4][5]
summary(hw4_lm)[4][1]
summary(hw4_lm)[4][2,2]
summary(hw4_lm)[4][2]
summary(hw4_lm)[4][3]
summary(hw4_lm)[4][4]
summary(hw4_lm)[4][5]
summary(hw4_lm)[4][6]
summary(hw4_lm)[4][1]
coefficients(m) # model coefficients
coefficients(hw4_lm)
coefficients(hw4_lm)[2]
confhw <- confint(hw4_lm,level =0.95)
summary(hw4_lm)
confhw <- confint(hw4_lm,level =0.95)
confhw[1][2]
confhw[1]
confhw
confhw[2]
confhw[6]
coefficients(hw4_lm)[2]
coefficients(hw4_lm)
confhw[3]
confhw[7]
qt(1-0.05/2,102-1-3)
tcrit
tcrit <- qt(1-0.05/2,102-1-3)
tcrit
plot(fitted(hw4_lm),residual_hw4,axes=TRUE, frame.plot=TRUE, xlab='fitted values', ylab='residue')
plot(fitted(hw4_lm),residual_hw4,axes=TRUE, frame.plot=TRUE, xlab='fitted values', ylab='residue')
abline(0,0)
par(mfrow=c(2,2))
plot(fitted(m), resid(m), axes=TRUE, frame.plot=TRUE, xlab='fitted values', ylab='residue')
plot(ceo1$age, resid(m), axes=TRUE, frame.plot=TRUE, xlab='age', ylab='residue')
plot(ceo1$height, resid(m), axes=TRUE, frame.plot=TRUE, xlab='height', ylab='residue')
hist(resid(m))
outlierTest(hw4_lm)
b <- influence.measures(hw4_lm)
c <- which(apply(b$is.inf, 1, any))
hw4_data[rownames(hw4_data) %in% c, ]
plot(ceo1$age, resid(m), axes=TRUE, frame.plot=TRUE, xlab='age', ylab='residue')
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(car)
hw4_data <- read.csv("./A04.csv")
attach(hw4_data)
#summary(hw4_data)
hw4_df <- data.frame(Education_Level = hw4_data$EL,
Income = hw4_data$Inc,
Women_Percentage = hw4_data$Perc,
Prestige_Score = hw4_data$Score)
pairs(hw4_df)
plot(EL ,Score, xlab = "Education Level (years)", ylab = "Prestige Score")
EL_Score_cor <- cor(EL,Score)
hw4_m_el <- lm(Score ~ EL,data = hw4_df)
resid_el <-resid(hw4_m_el)
summary(hw4_m_el)
par(mfrow = c(1,2))
plot(EL ,resid_el ,xlab = "Education level (years)",ylab = "Residual", main = "Residual Plot")
abline(0, 0)
hist(resid_el,main = "Histogram plot of residuals")
outlierTest(hw4_m_el)
b <- influence.measures(hw4_m_el)
c <- which(apply(b$is.inf, 1, any))
hw4_data[rownames(hw4_data) %in% c, ]
hw4_lm<-lm(Score ~ EL + Inc + Perc,data = hw4_data)
residual_hw4 <- resid(hw4_lm)
summary(hw4_lm)
summary(hw4_lm)
tcrit <- qt(1-0.05/2,102-1-3)
summary(hw4_lm)
confhw <- confint(hw4_lm,level =0.95)
plot(fitted(hw4_lm),residual_hw4,axes=TRUE, frame.plot=TRUE, xlab='fitted values', ylab='residue')
plot(EL, residual_hw4, axes=TRUE, frame.plot=TRUE, xlab='education level', ylab='residue')
plot(Inc, residual_hw4, axes=TRUE, frame.plot=TRUE, xlab='income', ylab='residue')
plot(Perc, residual_hw4, axes=TRUE, frame.plot=TRUE, xlab='percentage of women', ylab='residue')
hist(residual_hw4)
abline(0,0)
plot(fitted(hw4_lm),residual_hw4,axes=TRUE, frame.plot=TRUE, xlab='fitted values', ylab='residue')
abline(0,0)
plot(EL, residual_hw4, axes=TRUE, frame.plot=TRUE, xlab='education level', ylab='residue')
abline(0,0)
plot(Inc, residual_hw4, axes=TRUE, frame.plot=TRUE, xlab='income', ylab='residue')
abline(0,0)
plot(Perc, residual_hw4, axes=TRUE, frame.plot=TRUE, xlab='percentage of women', ylab='residue')
abline(0,0)
hist(residual_hw4)
